<!DOCTYPE html>
<html lang="en">

<head>
    <title>Sample 7 everything</title>
</head>

<body cp-app="forthyear">

    <div>
        <span>Id</span> <input type="number" cp-model="newObj.newId" /> <br />
        <span>Name</span> <input type="text" cp-model="newObj.newName" /> <br />
        <span>Date</span> <input type="date" cp-model="newObj.newDate" /> <br />
        <button @click="addSt()">Add</button>
    </div>

    <div cp-if="newAddedSt.Id">
        <span>the new St id: {{newAddedSt.newId}}</span>
        <span>the new St Name: {{newAddedSt.newId | lower}}</span>
        <span>the new St Date: {{newAddedSt.newId | date:'dd/mm/yyyy'}}</span> <!-- any date format you want  -->
    </div>

    <table>
        <thead>
            <th cp-for="k,v in obj[0]">{{k}}</th>
        </thead>
        <tr cp-for="st in obj">
            <td cp-for="s in st">{{s}}</td>
        </tr>
    </table>


    <script>
        function forthyear() {
            let scope = this;
            scope.newObj = {};
            scope.newAddedSt = {};
            scope.obj = [
                { id: 1, name: "St1", birthdate: new Date() },
                { id: 2, name: "St2", birthdate: new Date() },
                { id: 3, name: "St3", birthdate: new Date() },
                { id: 4, name: "St4", birthdate: new Date() },
                { id: 5, name: "St5", birthdate: new Date() },
                { id: 6, name: "St6", birthdate: new Date() },
            ]
            scope.addSt = function () {
                scope.newAddedSt = Object.assign({}, scope.newObj)
                scope.obj.push(Object.assign({}, scope.newObj));
                scope.newObj = {};
            }
        };

        var forthyear = new forthyear();

    </script>

</body>
<script type="text/javascript">
  let renders = [];
  let new_elements = [];
  let changes = [];

    //cp model template 
    if (forthyear.newObj.newId) {
      document.getElementById("Generated ID").value =
        forthyear.newObj.newId;
    }
    document.getElementById("Generated ID").addEventListener("input", (event) => {
      forthyear.newObj.newId = event.target.value;
    });

    //cp model template 
    if (forthyear.newObj.newName) {
      document.getElementById("Generated ID").value =
        forthyear.newObj.newName;
    }
    document.getElementById("Generated ID").addEventListener("input", (event) => {
      forthyear.newObj.newName = event.target.value;
    });

    //cp model template 
    if (forthyear.newObj.newDate) {
      document.getElementById("Generated ID").value =
        forthyear.newObj.newDate;
    }
    document.getElementById("Generated ID").addEventListener("input", (event) => {
      forthyear.newObj.newDate = event.target.value;
    });

	 // cp-event 
      const event_handler_Generated ID_click = function() {
        document.getElementById("Generated ID").addEventListener("click", (event) => {
            forthyear.addSt();
        });
    }
    changes.push(event_handler_Generated ID_click);

   //Curly Braces Renderer
    const curly_render_function_Generated ID_newAddedSt.newId = function() {
    const defaultText = "the new St id: {{newAddedSt.newId}}";
    if(forthyear.newAddedSt.newId !== undefined) {
      document.getElementById("Generated ID").innerHTML = defaultText.replace(
        `{{newAddedSt.newId}}`,
        forthyear.newAddedSt.newId
      )
    }
  }
  renders.push(curly_render_function_Generated ID_newAddedSt.newId);

   //Curly Braces Renderer
    const curly_render_function_Generated ID_newAddedSt.newId = function() {
    const defaultText = "the new St Name: {{newAddedSt.newIdpipe: lower
}}";
    if(forthyear.newAddedSt.newId !== undefined) {
      document.getElementById("Generated ID").innerHTML = defaultText.replace(
        `{{newAddedSt.newId}}`,
        forthyear.newAddedSt.newId
      )
    }
  }
  renders.push(curly_render_function_Generated ID_newAddedSt.newId);

   //Curly Braces Renderer
    const curly_render_function_Generated ID_newAddedSt.newId = function() {
    const defaultText = "the new St Date: {{newAddedSt.newIdpipe: date : dd/mm/yyyy
}}";
    if(forthyear.newAddedSt.newId !== undefined) {
      document.getElementById("Generated ID").innerHTML = defaultText.replace(
        `{{newAddedSt.newId}}`,
        forthyear.newAddedSt.newId
      )
    }
  }
  renders.push(curly_render_function_Generated ID_newAddedSt.newId);

 var cpFor_Generated ID = function (event) {
        let originalElement = document.getElementById("Generated ID");
        let container = originalElement.parentElement;

        for (var z in obj[0]) {
          let elem = originalElement.cloneNode(true);
          
          v=obj[0][z]
          k=z
          elem.id = "Generated ID" + z;

   //Curly Braces Renderer
    const curly_render_function_Generated ID_k = function() {
    const defaultText = "{{k}}";
    if(forthyear.k !== undefined) {
      document.getElementById("Generated ID").innerHTML = defaultText.replace(
        `{{k}}`,
        forthyear.k
      )
    }
  }
  renders.push(curly_render_function_Generated ID_k);


          elem.hidden = false;
          container.appendChild(elem);
          new_elements.push(elem);
        }
        originalElement.hidden = true;
      };
      renders.push(cpFor_Generated ID);


 var cpFor_Generated ID = function (event) {
        let originalElement = document.getElementById("Generated ID");
        let container = originalElement.parentElement;

        for (var z in obj) {
          let elem = originalElement.cloneNode(true);
          
          st=obj[z]
          
          elem.id = "Generated ID" + z;

 var cpFor_Generated ID = function (event) {
        let originalElement = document.getElementById("Generated ID");
        let container = originalElement.parentElement;

        for (var z in st) {
          let elem = originalElement.cloneNode(true);
          
          s=st[z]
          
          elem.id = "Generated ID" + z;


          elem.hidden = false;
          container.appendChild(elem);
          new_elements.push(elem);
        }
        originalElement.hidden = true;
      };
      renders.push(cpFor_Generated ID);


   //Curly Braces Renderer
    const curly_render_function_Generated ID_s = function() {
    const defaultText = "{{s}}";
    if(forthyear.s !== undefined) {
      document.getElementById("Generated ID").innerHTML = defaultText.replace(
        `{{s}}`,
        forthyear.s
      )
    }
  }
  renders.push(curly_render_function_Generated ID_s);


          elem.hidden = false;
          container.appendChild(elem);
          new_elements.push(elem);
        }
        originalElement.hidden = true;
      };
      renders.push(cpFor_Generated ID);


  function render() {
    setInterval(() => {
    for(let i = 0; i < new_elements.length; i++) {
          new_elements[i].remove();
      }
      for(let i = 0; i < changes.length; i++) {
          changes[i]();
      }
      changes = [];
      for (let i = 0; i < renders.length; i++) {
         renders[i]();
      }
    }, 1000);
  }
  render();

</script>